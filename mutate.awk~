#!/bin/awk -f
## http://awkology.wordpress.com/2010/02/08/mutate-dna/
BEGIN{
    srand(ARGV[1]);
    #srand(0); #reproducible
    ORS="";
}
{
    if (NR%4!=2) print $0"\n" #for reading fastq
    else {
	split(toupper($1),dna,"") #to upper case
	for(i=1;i<=length(dna);i++){
	    r=int((rand()*4)+1)
	    ## mutate all or a fraction of bases
	    f=0
	    # f=int((rand()*10)+1)
	    i=i+f
	    split("AGTC",nt,"")
	    dna[i]=nt[r]
	}
	for(i in dna) print dna[i]
	print "\n"
    }
}